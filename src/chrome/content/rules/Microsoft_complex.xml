<!--
	For rules causing false/broken MCB, see Microsoft.com-falsemixed.xml.


	Other Microsoft rulesets:

		- Acik_Akademi.com.xml
		- Afx.ms.xml
		- AKA.ms.xml
		- ASP.NET.xml
		- ASPNETcdn.com.xml
		- Azure.com.xml
		- AzurecomCDN.net.xml
		- Azure_websites.net.xml
		- Bing.xml
		- Bing.net.xml
		- Ch9.ms.xml
		- Codeplex.xml
		- Digital_WPC.com.xml
		- DreamSpark.com.xml
		- Get_Tag.mobi.xml
		- Gfx.ms.xml
		- Halo.xml
		- Hotmail.co.jp.xml
		- Hotmail.co.uk.xml
		- Hotmail.com.xml
		- Live.xml
		- Live.net.xml
		- Live_filestore.com.xml
		- Microsoft-Atlas.xml
		- Microsoft_Online-p.com.xml
		- Microsoft_Online-p.net.xml
		- Microsoft_Online_Services.xml
		- Microsoft_Ventures.com.xml
		- Microsoft_Store.xml
		- Modern.IE.xml
		- Moreinterop.com.xml
		- MSDN.xml
		- Msecnd.net.xml
		- MSN.xml
		- Newsvine.com.xml
		- Office.com.xml
		- Office.net.xml
		- Office365.com.xml
		- OneDrive.com.xml
		- OneNote.com.xml
		- OneNote.net.xml
		- Onestore.ms.xml
		- Outlook_Live.xml
		- Passport.net.xml
		- Photosynth.xml
		- Sfx.ms.xml
		- Skype.xml
		- Skype_assets.com.xml
		- S-Microsoft.com.xml
		- S-msn.com.xml
		- So.cl.xml
		- Surface.com.xml
		- Sway.xml
		- System_Center_Advisor.com.xml
		- Technet.com.xml
		- Technical_Community.com.xml
		- VSIP_Program.com.xml
		- Virtualearth.net.xml
		- Visual_Studio.com.xml
		- WLxrs.com.xml
		- WPdev.ms.xml
		- Windows_Azure.xml
		- Windows.com.xml
		- Windows.net.xml
		- Windows_Phone.xml
		- Xbox.xml
		- Xbox_Live.com.xml
		- Yammer.xml


	CDN buckets:

		- i.g.mobile.ms.akadns.net

			- i1.mobile.microsoft.com

		- i.g.social.ms.akadns.net

			- i1.social.s-msft.com

		- res.windows.microsoft.com.edgesuite.net

			- a1737.g2.akamai.net
			- res2.windows.microsoft.com

		- wscont.apps.microsoft.com.edgesuite.net

			- wscont[12].apps.microsoft.com

		- az12410.vo.msecnd.net
		- az373151.vo.msecnd.net	(used on imaginecup.com)
		- msstore.vo.msecnd.net
		- officeimg.vo.msecnd.net

	msnportalmobileisv.112.2o7.net


	Nonfunctional domains:

		- www.buildmypinnedsite.com
		- (www.)imaginecup.com ***
		- compete.imaginecup.com ***

		- microsoft.com subdomains:

			- developer		(404)
			- silverlight.dlservice *
			- download *
			- web.esd *		(esd, origin, origin-web, and web don't exist)
			- ignite		(Mismatched)
			- samples.msdn		(refused)
			- visualstudiogallery.msdn	(redirects to http, valid cert)
			- mymfe			(reset)
			- news			(Redirects to http)
			- officeimages
			- onlinehelp		(Refused)
			- i[1-3]?.onlinehelp *
			- outlook ***
			- privacy		(times out)
			- academic.research ***
			- sharepoint		(redirects to login.live.com, cert valid)
			- i1.gallery.technet	(Mismatched)
			- vepexp		(refused)
			- edir.windowsm		(404)
			- visio **
			- (www.)windows **

		- msimg.com
		- blog.surface.com		(handshake fails)
		- (www.)windowsteamblog.com

	* 503, akamai
	** 404, cert valid
	*** Times out


	Problematic domains:


		- microsoft.com subdomains:

			- (www.)? ¹
			- apps			(works; mismatched, CN: *.apps.microsoft.com)
			- wscont[12].apps	(works, akamai)
			- i[1-4].connect **
			- i\d **
			- ie	(mismatched, CN: *.azurewebsites.net)
			- i1.mobile **
			- i[1-4].code.msdn	(Mismatched)
			- i[23]?.msdn **
			- scache **
			- search **
			- spcache		(504, akamai)
			- img3.store		(mismatched)
			- i[23]?.technet **
			- social.technet
			- update *
			- www.update		(Untrusted root)
			- windows *
			- res[1-4].windows **

		- compass.surface.com **

	¹ Sets HSTS, thereby breaking oem/; however, Microsoft's website links to https://www....
	* Cert only matches www
	** akamai
	⁷ Mixed css from i3.technet.microsoft.com and i1.social.s-msft.com

	Partially covered microsoft.com subdomains:

		- answers		(some pages redirect to http)
		- tag ¹
		- social.technet *

	¹ Some pages redirect to http
	* Avoiding false/broken MCB


	Fully covered microsoft.com subdomains:

		- (www.)?
		- account
		- accountservices
		- feedback.adcenter
		- ajax
		- fb.answers
		- wscont.apps
		- wscont[12].apps	(→ wscont.apps)
		- assets
		- azure
		- advertise.bingads
		- secure.bingads
		- blogs
		- c
		- c1
		- choice
		- commerce
		- compass-ssl

		- connect subdomains:

			- ^
			- i[1-4]		(→ services)
			- innovation
			- services

		- sas.css
		- curah
		- social.expression
		- g
		- insider
		- js
		- learning
		- m
		- widgets.membership
		- mobile
		- i1.mobile		(→ m)

		- msdn
		- apisandbox.msdn
		- code.msdn
		- i[1-4].code.msdn		(→ i1.code.s-msft.com)
		- events.msdn
		- i[23]?.msdn			(→ msdn.microsoft.com)
		- lab.msdn
		- social.msdn
		- visualstudiogallery.msdn

		- mspartner
		- logobuilder.mspartner
		- mspartnerlp.mspartner

		- mvastorage
		- oem
		- office15client
		- officepreview
		- officeredir
		- o15.officeredir
		- training.partner
		- rad
		- readytogo
		- profileapi.services
		- social
		- services.social
		- corp.sts
		- support
		- sxp

		- technet
		- gallery.technet
		- i[1-4].gallery.technet	(→ i1.gallery.technet.s-msft.com)
		- i[23]?.technet		(→ technet.microsoft.com)

		- res[12].windows	(→ akamai)


	These altnames don't exist:

		- secure.answers.microsoft.com
		- answers-sancert.microsoft.com


	Observed cookie domains:

		- .office.microsoft.com
		- .support.microsoft.com
		- .technet.microsoft.com ²

	² Not secured by us <= used on domains subject to false MCB


	Insecure cookies are set for these domains and hosts:

		- .microsoft.com
		- account.microsoft.com
		- careers.microsoft.com
		- choice.microsoft.com
		- connect.microsoft.com
		- curah.microsoft.com
		- learning.microsoft.com

		- msdn.microsoft.com
		- apisandbox.msdn.microsoft.com
		- .apisandbox.msdn.microsoft.com
		- code.msdn.microsoft.com
		- lab.msdn.microsoft.com
		- visualstudiogallery.msdn.microsoft.com

		- mspartner.microsoft.com
		- logobuilder.mspartner.microsoft.com
		- mspartnerlp.mspartner.microsoft.com

		- training.partner.microsoft.com
		- gallery.technet.microsoft.com
		- social.technet.microsoft.com
		- support.microsoft.com
		- support2.microsoft.com
		- sxp.microsoft.com


	Mixed content:

		- css, on:
		- css on onlinehelp from i3.onlinehelp *
			- social.technet from i3.technet *
			- social.technet from i1.social.s-msft.com *

		- Fonts on careers from i.s-microsoft.com *

		- Images, on:
			- blogs from mscorp.blob.core.windows.net *
			- insider from c *
		- Images on onlinehelp from i.onlinehelp *
			- support from $self *
		- Images on smallbusiness.support from support
		- Images on smallbusiness.support from www *
			- social.technet from i1.social.s-msft.com *
			- sxp from az648995.vo.msecnd.net
			- sxp from blogs.msdn.com
			- sxp from blogs.technet.com
			- mspartnerlp.mspartner from v3lpastorage.blob.core.windows.net *

		- Bugs, on:

			- msdn from msstonojsmsdn.112.2o7.net *
			- technet from msstonojstechnet.112.2o7.net *
			- social.technet from msstonojssocial.112.2o7.net *
			- careers, msdn, logobuilder.mspartner, pinpoint, technet, social.technet from m.webtrends.com
			- blogs, curah, www from c.microsoft.com *
			- sxp from blogs.msdn.com
			- sxp from blogs.technet.com

	* Secured by us

-->
<ruleset name="Microsoft.com Complex (partial)">

		<!--exclusion pattern="^http://msdn\.microsoft\.com/" /-->

		<!--	https://mail1.eff.org/pipermail/https-everywhere-rules/2012-June/001189.html
											-->
		<!--exclusion pattern="^http://www\.microsoft\.com/.*[fF]amily[iI][dD]" /-->

		<!--	Health pages 404:

				https://trac.torproject.org/projects/tor/ticket/9148
											-->
		<!--exclusion pattern="^http://(?:www\.)?microsoft\.com/health/(?:$|\?|.+\.aspx)" /-->

			<test url="http://www.microsoft.com/en-us/health/default.aspx" />
			<test url="http://www.microsoft.com/health" />

		<!--	Redirects via JS to http.  Very secure indeed.
									-->
		<!--exclusion pattern="^http://www\.microsoft\.com/security/.+\.aspx(?:$|\?)" /-->

			<test url="http://www.microsoft.com/security/default.aspx" />

		<!--	Microsoft won't serve OEM pages on https
								-->
		<!--exclusion pattern="^http://(?:www\.)?microsoft\.com/[oO][eE][mM]/" /-->

			<!--test url="http://www.microsoft.com/oem/en/pages/index.aspx" /-->

	<target host="answers.microsoft.com" />
		<!--	Redirects to http:
						-->
		<!--exclusion pattern="^http://www\.microsoft\.com/Surface/\w\w-\w\w(?:$|[?/])" /-->
		<rule from="^http://answers\.microsoft\.com/(\w\w-\w\w/\w+/forum/[\w-]+/[\w-]+/|static/)"
				to="https://answers.microsoft.com/$1" />

			<!--	+ve:
					-->
			<test url="http://answers.microsoft.com/cs-cz/badges/community-leaders" />
			<test url="http://answers.microsoft.com/de-de/badges/mcc" />
			<test url="http://answers.microsoft.com/en-us/page/forums" />
			<test url="http://answers.microsoft.com/en-us/page/faq" />
			<test url="http://answers.microsoft.com/en-us/page/gettingstarted" />
			<test url="http://answers.microsoft.com/es-es/" />

			<!--	-ve:
					-->
			<test url="http://answers.microsoft.com/static/css/core.css" />

		<!--	https://trac.torproject.org/projects/tor/ticket/5754
										-->
		<!--exclusion pattern="^http://msdn\.microsoft\.com/(?:$|en-us/$|.+(?:/$|\.aspx|/\w\w\d{6,10}$))" /-->

			<!--	+ve:
					-->
			<test url="http://msdn.microsoft.com/" />
			<test url="http://msdn.microsoft.com/en-us/" />

		<!--exclusion pattern="^http://code\.msdn\.microsoft\.com/(?![cC]content/|RequestReduceContent/)" /-->

			<test url="http://code.msdn.microsoft.com/vstudio/" />

	<target host="search.microsoft.com" />
		<!--	Some data exist on www, exclude the rest here.
									-->
		<rule from="^http://search\.microsoft\.com/(global/oneMscomSettings/|shared/)"
				to="https://search\.microsoft\.com/$1" />

			<!--	+ve:
					-->
			<test url="http://search.microsoft.com/default.aspx" />
			<test url="http://search.microsoft.com/search/results.aspx" />

			<!--	-ve:
					-->
			<test url="http://search.microsoft.com/shared/" />

		<!--exclusion pattern="^http://technet\.microsoft\.com/(?!en-us/(?:library/[^.]\.rss(?:$|\?)|security/(?:advisory|bulletin)(?:$|[?/])))" /-->

			<!--	+ve:
					-->
			<test url="http://technet.microsoft.com/video" />

			<!--	-ve:
					-->
			<test url="http://technet.microsoft.com/en-us/security/advisory" />
			<test url="http://technet.microsoft.com/en-us/security/bulletin" />

		<target host="careers.microsoft.com" />
		<!--	Redirect to http:
						-->
		<rule from="^http://careers\.microsoft\.com/"
				to="https://careers.microsoft.com" />
		<exclusion pattern="^http://careers\.microsoft\.com/careers/\w\w/\w\w/" />

			<!--	+ve:
					-->
			<test url="http://careers.microsoft.com/careers/en/us/university-apply-non-technical.aspx" />
			<test url="http://careers.microsoft.com/careers/fr/fr/home.aspx" />

			<!--	-ve:
					-->
			<test url="http://careers.microsoft.com/Css/LanguageBar.css" />
			<test url="http://careers.microsoft.com/Images/gear.png" />
			<test url="http://careers.microsoft.com/appliedjobs.aspx" />
			<test url="http://careers.microsoft.com/favicon.ico" />
			<test url="http://careers.microsoft.com/global/careers/RenderingAssets/FR.css" />
			<test url="http://careers.microsoft.com/jobalerts.aspx" />
			<test url="http://careers.microsoft.com/search.aspx" />
			<test url="http://careers.microsoft.com/shared/core/2/css/css.ashx" />
			<test url="http://careers.microsoft.com/shared/templates/master/gcmodern/images/msft-logo.png" />


		<!--
			Exceptions:
					-->
		<!--exclusion pattern="^http://careers\.microsoft\.com/+(?!Css/|Images/|(?:appliedjobs|jobalerts|search)\.aspx|favicon\.ico|global/|shared/)" /-->

		<target host="tag.microsoft.com" />
		<!--exclusion pattern="^http://tag\.microsoft\.com/home\.aspx" /-->
		<rule from="^http://tag\.microsoft\.com/+([Aa]pp_[Tt]hemes/|favicon\.ico|Images/|[Ll]ibraries/|[Ww]eb[Rr]esource\.axd)"
				to="https://tag.microsoft.com/$1" />

			<!--	+ve:
					-->
			<test url="http://tag.microsoft.com/community.aspx" />
			<test url="http://tag.microsoft.com/help.aspx" />
			<test url="http://tag.microsoft.com/home.aspx" />
			<test url="http://tag.microsoft.com/my-tags/home.aspx" />
			<test url="http://tag.microsoft.com/resources.aspx" />
			<test url="http://tag.microsoft.com/tag-in-action.aspx" />
			<test url="http://tag.microsoft.com/what-is-tag.aspx" />

			<!--	-ve:
					-->
			<test url="http://tag.microsoft.com/App_Themes/TagV3/styles.css" />
			<test url="http://tag.microsoft.com/Images/V3/Header/homenavbg.png" />
			<test url="http://tag.microsoft.com/Libraries/Homepage_Hero_Footer/get_tag_title.sflb.ashx" />
			<test url="http://tag.microsoft.com/favicon.ico" />

	<target host="social.technet.microsoft.com" />
		<!--	Avoid false/broken MCB:
						-->
		<rule from="http://social\.technet\.microsoft\.com/+wiki(/CustomWidgets/|/themes/|/Utility/)"
				to="https://social.technet.microsoft.com/wiki$1" />
		<!--exclusion pattern="^http://social\.technet\.microsoft\.com/Forums(?:$|[?/])" /-->

			<!--	+ve:
					-->
			<test url="http://social.technet.microsoft.com/Forums" />
			<test url="http://social.technet.microsoft.com/Forums/en-US/home" />

			<!--	+ve:
					-->
			<test url="http://social.technet.microsoft.com/wiki/contents/articles/wiki-about-technet-wiki.aspx" />
			<test url="http://social.technet.microsoft.com/wiki/contents/articles/wiki-getting-started.aspx" />
			<test url="http://social.technet.microsoft.com/wiki/contents/articles/wiki-how-to-contribute.aspx" />
			<test url="http://social.technet.microsoft.com/wiki/contents/articles/wiki-how-to-get-help.aspx" />
			<test url="http://social.technet.microsoft.com/wiki" />
			<test url="http://social.technet.microsoft.com/wiki/" />

	<target host="go.microsoft.com" />
		<rule from="^http://go\.microsoft\.com/"
				to="https://go.microsoft.com/" />
		<!--	Needed for Windows 8+ Captive Portal Helper:
			See https://github.com/EFForg/https-everywhere/issues/835
						-->
		<exclusion pattern="^http://go\.microsoft\.com/fwlink/\?LinkID=219472&amp;clcid=0x409$" />

			<test url="http://go.microsoft.com/fwlink/?LinkID=219472&amp;clcid=0x409" />

	<!--	Not secured by server:
					-->
	<!--securecookie host="^\.microsoft\.com$" name="^(A|FedCountryOfChoice|MC1|MS-CV|MS0|gssLANG|msdn|smcexpsessionticket|smcexpticket|smcflighting)$" /-->
	<!--securecookie host="^account\.microsoft\.com$" name="^oref$" /-->
	<!--securecookie host="^(careers|support)\.microsoft\.com$" name="^ASP\.NET_SessionId$" /-->
	<!--securecookie host="^choice\.microsoft\.com$" name="^PPLState$" /-->
	<!--securecookie host="^connect\.microsoft\.com$" name="^BlueStripe\.PVN$" /-->
	<!--securecookie host="^curah\.microsoft\.com$" name="^__RequestVerificationToken$" /-->
	<!--securecookie host="^learning\.microsoft\.com$" name="^(ASP\.NET_SessionId|CampaignHistory|MSCSProfile|loc)$" /-->
	<!--securecookie host="^msdn\.microsoft\.com$" name="^(__RequestVerificationToken|TocHashCookie)$" /-->
	<!--securecookie host="^apisandbox\.msdn\.microsoft\.com$" name="^(ai_session|ai_user)$" /-->
	<!--securecookie host="^\.apisandbox\.msdn\.microsoft\.com$" name="^ARRAffinity$" /-->
	<!--securecookie host="^(code|visualstudiogallery)\.msdn\.microsoft\.com$" name="^ssostate$" /-->
	<!--securecookie host="^lab\.msdn\.microsoft\.com$" name="^ASP\.NET_SessionId$" /-->
	<!--securecookie host="^mspartner\.microsoft\.com$" name="^(ai_session|ai_user)$" /-->
	<!--securecookie host="^logobuilder\.mspartner\.microsoft\.com$" name="^(__RequestVerificationToken|UiLanguageCode)$" /-->
	<!--securecookie host="^mspartnerlp\.mspartner\.microsoft\.com$" name="^(__RequestVerificationToken|ASP\.NET_SessionId|pathState)$" /-->
	<!--securecookie host="^training\.partner\.microsoft\.com$" name="^(ASP\.NET_SessionId|BlueStripe\.PVN|SUMTOTALAUTH)$" /-->
	<!--securecookie host="^support\.microsoft\.com$" name="^(\.ASPXANONYMOUS|SMC_SAGE|smcexpsessionticket|smcexpticket)$" /-->
	<!--securecookie host="^support2\.microsoft\.com$" name="^(\.ASPXANONYMOUS|GsfxSessionCookie|GsfxStatsLog)$" /-->
	<!--securecookie host="^smallbusiness\.support\.microsoft.com$" name="^(breadcrumb|culture|exitinfo)$" /-->
	<!--securecookie host="^sxp\.microsoft\.com$" name="^m0$" /-->
	<!--securecookie host="^\.technet\.microsoft\.com$" name="^AuthorizationCookie$" /-->
	<!--securecookie host="^gallery\.technet\.microsoft\.com$" name="^ssostate$" /-->
	<!--securecookie host="^social\.technet\.microsoft\.com$" name="^(\.ASPXANONYMOUS|__RequestVerificationToken_\w+|CSExtendedAnalytics(Session)?$" /-->
	<!--securecookie host="^www\.microsoft\.com$" name="^(defCulture|mslocale)$" /-->

	<!--	A, MC1, MS0: Cookies set by c.microsoft.com
		s_.+: Other tracking cookies
						-->
	<securecookie host="^\.microsoft\.com$" name="^(?:A|GsfxStatsLog|MC1|MS0|OnlineTrackingV2\.0|R|RioTracking\..+|s_.+)$" />
	<securecookie host="^(?:account|feedback\.adcenter|advertising|advertise\.bingads|choice|commerce|connect|curah|ieonline|learning|m|msdn|(?:\.?apisandbox|lab|visualstudiogallery)\.msdn|mspartner|(?:logobuilder|mspartnerlp)\.mspartner|\.?office|office(?:15client|2010|preview|redir)|training\.partner|corp\.sts|\.?support|support2|sxp|gallery\.technet|\.?www)\.microsoft\.com$" name=".+" />
	<securecookie host="^social\.technet\.microsoft\.com$" name="^CSExtendedAnalytics(?:Session)?$" />


	<rule from="^http://wscont\d\.apps\.microsoft\.com/"
		to="https://wscont.apps.microsoft.com/" />

		<target host="wscont1.apps.microsoft.com" />
		<target host="wscont1.apps.microsoft.com" />

	<rule from="^http://i\d\.microsoft\.com/"
		to="https://i.microsoft.com/" />

		<target host="i2.microsoft.com" />
		<target host="i3.microsoft.com" />
		<target host="i4.microsoft.com" />

		<test url="http://i.answers.microsoft.com/static/css/core.css" />
		<test url="http://i2.answers.microsoft.com/static/css/pagecontrols.css" />
		<test url="http://i3.answers.microsoft.com/static/css/search.css" />
		<test url="http://i.msdn.microsoft.com/" />
		<test url="http://i.msdn.microsoft.com//" />
		<test url="http://i.services.social.microsoft.com/" />

	<rule from="^http://i\d\.connect\.microsoft\.com/"
		to="https://services.connect.microsoft.com/" />
		<target host="i1.connect.microsoft.com" />
		<target host="i2.connect.microsoft.com" />
		<target host="i3.connect.microsoft.com" />
		<target host="i4.connect.microsoft.com" />

	<rule from="^http://i1\.mobile\.microsoft\.com/"
		to="https://m.microsoft.com/" />

		<target host="i1.mobile.microsoft.com" />

	<rule from="^http://img3\.store\.microsoft\.com/"
		to="https://msstore.vo.msecnd.net/" />

		<test url="http://img3.store.microsoft.com/" />

	<rule from="^http://res(1|2)\.windows\.microsoft\.com/"
		to="https://a248.e.akamai.net/f/1737/7533/6/res$1.windows.microsoft.com/" />

		<target host="res1.windows.microsoft.com" />
		<target host="res2.windows.microsoft.com" />
		<test url="http://res2.windows.microsoft.com/resources/4.2/wol/shared/images/merged/gl_social.svg" />

</ruleset>
